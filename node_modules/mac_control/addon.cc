#include <ApplicationServices/ApplicationServices.h>
#include <node.h>
#include <v8.h>

using namespace v8;
 
Handle<Value> Press(const Arguments& args) {
        
        CGEventRef down = CGEventCreateKeyboardEvent(NULL, (CGKeyCode) args[0]->NumberValue(), true);
      CGEventPost(kCGHIDEventTap, down);
      CFRelease(down);
    
     //return args[0];
}
 
Handle<Value> Release(const Arguments& args) {
    
    CGEventRef up = CGEventCreateKeyboardEvent(NULL, (CGKeyCode) args[0]->NumberValue(), false);
  CGEventPost(kCGHIDEventTap, up);
  CFRelease(up);
    
    //return args[0];

}
 
void init(Handle<Object> target) {
    target->Set(String::NewSymbol("press"),
        FunctionTemplate::New(Press)->GetFunction());
 
    target->Set(String::NewSymbol("release"),
        FunctionTemplate::New(Release)->GetFunction());
}
NODE_MODULE(addon, init)